# これで送迎 - 送迎スケジューリングアプリケーション

施設での利用者送迎計画を最適化するためのアプリケーションです。職員、利用者、車両の情報を入力することで、最適な送迎ルートとシフトを自動的に計算します。

## 機能

- 職員情報管理（名前、運転可能か、勤務曜日など）
- 利用者情報管理（名前、住所、通所曜日、特記事項など）
- 車両情報管理（車両名、乗車可能人数）
- 送迎ルートの最適化（OR-Toolsを使用）
- 曜日ごと、時間帯（朝/夕方）ごとの送迎スケジュール表示
- **Google Mapsを使用したルート表示**
- **送迎スケジュールのExcel出力**
- **職員・利用者・車両データのExcelインポート/エクスポート**
- **ChatGPTを使用したスケジュールチェック機能**

## 必要条件

- Python 3.7以上
- 必要なライブラリ（requirements.txtを参照）

## インストール方法

1. リポジトリをクローンまたはダウンロードする
2. 必要なライブラリをインストールする
   ```
   pip install -r requirements.txt
   ```

## 使い方

1. アプリケーションを起動する
   ```
   python src/main.py
   ```

2. サンプルデータを含めて起動する場合
   ```
   python src/main.py --sample
   ```

3. 各タブの説明
   - **職員タブ**: 送迎に関わる職員情報を登録・管理します。
   - **利用者タブ**: 送迎が必要な利用者の情報を登録・管理します。
   - **車両タブ**: 使用する車両情報を登録・管理します。
   - **送迎スケジュールタブ**: 登録された情報をもとに最適な送迎ルートを計算・表示します。
   - **設定タブ**: 施設の住所やAPIキーなどの基本設定を行います。

4. 最適化ステップ
   1. まず「職員」「利用者」「車両」タブで必要な情報を入力します。
   2. 「設定」タブで施設の住所を入力します。
   3. 「送迎スケジュール」タブで「送迎ルート最適化」ボタンをクリックします。
   4. 最適化が完了すると、曜日と時間帯ごとの送迎ルートが表示されます。

5. 新機能の使い方
   - **地図表示**: 送迎ルートを地図上で確認するには、「地図表示」ボタンをクリックします。
   - **Excel出力**: 送迎スケジュールをExcelで出力するには、「Excel」ボタンをクリックします。
   - **ChatGPTチェック**: スケジュールをChatGPTでチェックするには、「ChatGPTチェック用」ボタンをクリックし、生成されたテキストファイルをChatGPTに貼り付けてください。
   - **データのインポート/エクスポート**: 各タブ（職員、利用者、車両）にある「Excelエクスポート」「Excelインポート」ボタンを使用してデータの入出力が可能です。

## 注意事項

- 実際の道路状況や交通状況によって所要時間は変動します。
- Google Maps APIキーを入力すると、より正確なルート計算と地図表示が可能になります。
  （キーがない場合はダミーデータで動作します）
- 最適化結果は常に完璧ではないため、必要に応じて手動で調整してください。

## 技術情報

- UI: tkinter（Pythonの標準GUIライブラリ）
- 最適化エンジン: Google OR-Tools
- 距離計算: Google Maps Distance Matrix API（オプション）
- 地図表示: Google Maps JavaScript API
- 出力形式: Excel (openpyxl)

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
